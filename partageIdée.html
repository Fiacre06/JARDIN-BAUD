<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JardinExpress ‚Äì Reconnaissance de plante</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(to bottom, #e8f5e9, #ffffff);
  margin: 0;
  padding: 20px;
  text-align: center;
}

h1 {
  color: #2e8b57;
}

.container {
  max-width: 420px;
  margin: auto;
  background: #fff;
  padding: 20px;
  border-radius: 16px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.12);
}

input[type="file"] {
  width: 100%;
  margin: 15px 0;
}

button {
  width: 100%;
  padding: 12px;
  background: #2e8b57;
  color: #fff;
  font-size: 16px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}

button:hover {
  background: #256b45;
}

#preview {
  width: 100%;
  margin-top: 15px;
  border-radius: 12px;
  display: none;
}

#resultat {
  margin-top: 20px;
  text-align: left;
}

.loading {
  color: orange;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>üåø JardinExpress</h1>

<div class="container">
  <h3>Reconnaissance de plante par photo</h3>

  <input type="file" id="imageInput" accept="image/*" onchange="previewImage()">

  <img id="preview">

  <button onclick="identifierPlante()">Identifier la plante</button>

  <div id="resultat"></div>
</div>

<script>
/* üîë TA CL√â API PLANTNET */
const API_KEY = "2b10w0CtU68A5WGRCf67pwtXRe";

function previewImage() {
  const file = document.getElementById("imageInput").files[0];
  const preview = document.getElementById("preview");

  if (file) {
    preview.src = URL.createObjectURL(file);
    preview.style.display = "block";
  }
}

async function identifierPlante() {
  const input = document.getElementById("imageInput");
  const resultat = document.getElementById("resultat");

  if (!input.files.length) {
    alert("Veuillez s√©lectionner une image");
    return;
  }

  resultat.innerHTML = "<p class='loading'>üîç Analyse en cours...</p>";

  const formData = new FormData();
  formData.append("images", input.files[0]);
  formData.append("organs", "leaf");

  try {
    const response = await fetch(
      `https://my-api.plantnet.org/v2/identify/all?api-key=${API_KEY}`,
      {
        method: "POST",
        body: formData
      }
    );

    const data = await response.json();

    if (data.results && data.results.length > 0) {
      const plante = data.results[0].species;

      resultat.innerHTML = `
        <h4>‚úÖ Plante identifi√©e</h4>
        <p><b>Nom :</b> ${plante.commonNames[0] || "Non disponible"}</p>
        <p><b>Nom scientifique :</b> ${plante.scientificName}</p>
        <p><b>Fiabilit√© :</b> ${(data.results[0].score * 100).toFixed(1)}%</p>
      `;
    } else {
      resultat.innerHTML = "‚ùå Aucune plante reconnue";
    }

  } catch (erreur) {
    resultat.innerHTML = "‚ö†Ô∏è Erreur de connexion √† l‚ÄôAPI";
    console.error(erreur);
  }
}
</script>

</body>
</html>